{% extends "page_base.jinja" %}

{% block title %}
Mountain Rankings - Find the Easiest and Hardest Resorts in the USA
{% endblock title %}

{% block pagehead %}
<link href="/rankings.css" rel="stylesheet" />
{% endblock pagehead %}

{% block content %}
<section id="content">
    <h1>Mountain Rankings</h1>

    <ul class="ranking-sort">
        {% set sorts = {
            "difficulty": "Difficulty",
            "beginner": "Beginner Friendliness"
        } %}

        {% for key, label in sorts.items() %}
            {% if sort == key %}
                {% set new_order = "asc" if order == "desc" else "desc" %}
                <li>
                    <a href="/rankings?sort={{ key }}&order={{ new_order }}&region={{ region }}&state={{ state }}"
                    class="button-cta">
                        {{ label }} {% if order == "desc" %}&#x25bc;{% else %}&#x25b2;{% endif %}
                    </a>
                </li>
            {% else %}
                <li>
                    <a class="button-cta2"
                    href="/rankings?sort={{ key }}&order=asc&region={{ region }}&state={{ state }}">
                        {{ label }}
                    </a>
                </li>
            {% endif %}
        {% endfor %}
    </ul>

    <ul class="ranking-sort">
        {% set regions = ["usa", "northeast", "southeast", "midwest", "west"] %}
        {% for r in regions %}
            <li>
                {% if r == region and state == None %}
                    <a class="button-cta">{{ r|capitalize }}</a>
                {% else %}
                    <a class="button-cta2"
                    href="/rankings?sort={{ sort }}&order={{ order }}&region={{ r }}">
                        {{ r|capitalize }}
                    </a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    <form id="search-form" class="search-form" action="/rankings" method="get">
        <select id="state" name="state" required>
            <option value="" disabled {% if not state %}selected{% endif %}>Select State</option>
            {% set states = {
                "AL":"Alabama", "AK":"Alaska", "AZ":"Arizona", "AR":"Arkansas", "CA":"California",
                "CO":"Colorado", "CT":"Connecticut", "DE":"Delaware", "FL":"Florida", "GA":"Georgia",
                "HI":"Hawaii", "ID":"Idaho", "IL":"Illinois", "IN":"Indiana", "IA":"Iowa",
                "KS":"Kansas", "KY":"Kentucky", "LA":"Louisiana", "ME":"Maine", "MD":"Maryland",
                "MA":"Massachusetts", "MI":"Michigan", "MN":"Minnesota", "MS":"Mississippi", "MO":"Missouri",
                "MT":"Montana", "NE":"Nebraska", "NV":"Nevada", "NH":"New Hampshire", "NJ":"New Jersey",
                "NM":"New Mexico", "NY":"New York", "NC":"North Carolina", "ND":"North Dakota", "OH":"Ohio",
                "OK":"Oklahoma", "OR":"Oregon", "PA":"Pennsylvania", "RI":"Rhode Island", "SC":"South Carolina",
                "SD":"South Dakota", "TN":"Tennessee", "TX":"Texas", "UT":"Utah", "VT":"Vermont",
                "VA":"Virginia", "WA":"Washington", "WV":"West Virginia", "WI":"Wisconsin", "WY":"Wyoming"
            } %}
            {% for code, name in states.items() %}
                <option value="{{ code }}" {% if state == code %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>
        <input type="hidden" name="sort" value="{{ sort }}">
        <input type="hidden" name="order" value="{{ order }}">
        <input class="button-cta" id="submit" type="submit" value="Select" />
    </form>

    <p class="detail">
        {% if sort == "beginner" %}
        The Beginner Friendliness ranking is a weighted average of the easiest trails at each resort. It shows how easy
        it would be to learn to ski on these trails.
        The color denotes what the easiest trails at a mountain are rated. The longer the bar, the easier the learning
        terrain is.
        {% endif %}
        {% if sort == "difficulty"%}
        The Difficulty ranking is a weighted average of the hardest trails at each resort. It shows how much of a
        challenge the mountain will present to advanced skiers.
        The color denotes how challenging the hardest trails at a mountain are. The longer the bar, the harder the
        advanced trails at the resort. Expect the toughest trails at a resort to have pitches (in degrees) that are
        very similar to the difficulty score.
        {% endif %}
    </p>

    <p class="detail">
        {% if sort == "beginner" %}
        The Beginner Friendliness scale is from 0-30, where 0 is a resort with no trails even resembling a good
        place to learn. The best resorts for beginners have a wide variety of easy terrain, and their scores will
        be high to reflect that.
        {% endif %}
        {% if sort == "difficulty"%}
        The Difficulty scale is roughly from 0-60, where a mountain scoring highly presents extremely difficult terrain.
        Technically, the max possible score is ~100, but that would require a mix of terrible weather and deadly cliffs. 
        The steepest terrain is primarily in the west, and as such western resorts dominate the top of the Difficulty list.
        {% endif %}
    </p>

    <div id="ezoic-pub-ad-placeholder-102"></div>

    <div class="legend">
        <ul>
            <li><span class="icon difficulty-green"></span>Beginner</li>
            <li><span class="icon difficulty-royalblue"></span>Intermediate</li>
            <li><span class="icon difficulty-black"></span>Advanced</li>
            <li><span class="icon difficulty-red"></span>Expert</li>
            <li><span class="icon difficulty-gold"></span>Extreme</li>
        </ul>
    </div>

    <div class="rankings">
        {% for mountain in mountains %}
        {% if sort == "difficulty" %}
        <p>{{loop.index}}. <a href="/map/{{mountain.state}}/{{mountain.name}}"
                title="Difficulty: {{mountain.difficulty}}">
                {{mountain.name}}, {{mountain.state}}</a></p>
        <div class="bar-div"><span class="{{'ranking-bar' if mountain.difficulty <= 47 else 'black-text'}}"
            title="{{mountain.name}} Difficulty: {{mountain.difficulty}}"
            style="--bar-size: {{
                (mountain.difficulty)/55.2 * 100}}%; --bar-color: {{ 'green' if mountain.difficulty < 18 else 'royalblue' if mountain.difficulty 
                < 27 else 'black' if mountain.difficulty < 36 else 'red' if mountain.difficulty < 47 else 'gold' }};">{{mountain.difficulty}}
        </span></div>
        {% endif %}
        {% if sort == "beginner" %}
        <p>{{loop.index}}. <a href="/map/{{mountain.state}}/{{mountain.name}}"
                title="Beginner Friendliness: {{mountain.beginner_friendliness}}">
                {{mountain.name}}, {{mountain.state}}</a></p>
        <div class="bar-div"><span class="ranking-bar" title="{{mountain.name}} Beginner Friendliness: {{mountain.beginner_friendliness}}"
            style="--bar-size: {{
                (mountain.beginner_friendliness)/30 * 100}}%; --bar-color: {{ 'green' if mountain.beginner_friendliness > 12 else 'royalblue' 
                if mountain.beginner_friendliness > 3 else 'black' if mountain.beginner_friendliness > -6 else 'red' if 
                mountain.beginner_friendliness > -17 else 'gold' }};">{{mountain.beginner_friendliness}}
        </span></div>
        {% endif %}
        {% endfor %}
    </div>
    <div id="ezoic-pub-ad-placeholder-101"></div>
</section>
{% endblock content %}